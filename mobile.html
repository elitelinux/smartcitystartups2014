<!DOCTYPE html>
<html lang="en" ng-app="scs414">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <meta name="description" containernt="Smart City Startups 2014">
    <meta name="author" content="Stonly Baptiste">
    <link rel="shortcut icon" href="assets/img/favicon-scs.ico">

    <title>Smart City Startups 2014</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

		<link rel="stylesheet" type="text/css" href="assets/css/default.css" />
		<link rel="stylesheet" type="text/css" href="assets/css/component.css" />
		<script src="assets/js/modernizr.custom.js"></script>

    <!-- Fonts from Google Fonts -->
	<link href='http://fonts.googleapis.com/css?family=Lato:300,400,900' rel='stylesheet' type='text/css'>
    <style>
    	[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
  			display: none !important;
		}
    </style>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" id="mobile_bar" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#/" id="menu_top"><b>SMART CITY STARTUPS 2014</b>

          </a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right" onclick="$('#mobile_bar').click()">
            <li><a id="menu_decription" href="#/agenda" class="btn btn-outline-inverse">Agenda</a></li>
            <li><a id="menu_decription" href="#/map" class="btn btn-outline-inverse">Map</a></li>
            <li><a id="menu_decription" href="#/people" class="btn btn-outline-inverse">People</a></li>
            <!--<li><a id="menu_decription" href="#/groups" class="btn btn-outline-inverse">Groups</a></li>-->
            <!--<li><a id="menu_decription" href="#/vote" class="btn btn-outline-inverse">Vote</a></li>-->
            <li><a id="menu_decription" href="#/content" class="btn btn-outline-inverse">Content</a></li>
            <li><a id="menu_decription" href="#/contact" class="btn btn-outline-inverse">Contacts</a></li>
          </ul>
          <div class="" style="display:none; top: 39px;position: fixed;height: 5px;width: 50px;background-color: white;left: 857px;" id="menu_bar"></div>
        </div><!--/.nav-collapse -->
      </div>
    </div>

		<div class="container" ng-view style="margin-top:5%">
		</div>
		<hr>
		<p class="centered">&copy; <a href="http://Urban.Us">Urban.Us</a> 2014 - All logos are property of their respective owners</p>
	</div><!-- /container -->
	

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>

    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.appear.js"></script>
    <script src="assets/js/angular.js"></script>
    <script src="http://code.angularjs.org/1.0.6/angular-sanitize.js"></script>

    <!--<script src="assets/js/jquery.panzoom.js"></script>-->
 
    <script type="text/javascript">
    //credit http://upshots.org/javascript/jquery-test-if-element-is-in-viewport-visible-on-screen
		$.fn.isOnScreen = function(){
		     
		    var win = $(window);
		     
		    var viewport = {
		        top : win.scrollTop(),
		        left : win.scrollLeft()
		    };
		    viewport.right = viewport.left + win.width();
		    viewport.bottom = viewport.top + win.height();
		     
		    var bounds = this.offset();
		    bounds.right = bounds.left + this.outerWidth();
		    bounds.bottom = bounds.top + this.outerHeight();
		     
		    return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom));
		     
		};

    </script> 	    
    <script>
    //credit http://css-tricks.com/snippets/jquery/smooth-scrolling/
    $(function() {
	  $('a[href*=#]:not([href=#])').click(function() {
	    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
	      	var target = $(this.hash);
	      	target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
	      	console.log(target.selector)
	      	if (target.selector.indexOf('target_description') > -1) {
	      		ga('send', 'pageview', {'page': '/#what','title': 'Smart City Startups - What'});
	        	window.history.pushState({},'Smart City Startups - What','#what')
	        }	   
	      	if (target.selector.indexOf('target_participants') > -1) {
	      		ga('send', 'pageview', {'page': '/#who','title': 'Smart City Startups - Who'});
	        	window.history.pushState({},'Smart City Startups - Who','#who')
	        }	 
	      	if (target.selector.indexOf('target_location') > -1) {
	      		ga('send', 'pageview', {'page': '/#where','title': 'Smart City Startups - Where'});	      		
	        	window.history.pushState({},'Smart City Startups - Where','#where')
	        }	 

	      	if (target.selector.indexOf('target_schedule') > -1) {
	      		ga('send', 'pageview', {'page': '/#agenda','title': 'Smart City Startups - Agenda'});	      		
	        	window.history.pushState({},'Smart City Startups - Agenda','#agenda')
	        }	 
	      	if (target.selector.indexOf('target_sponsors') > -1) {
	      		ga('send', 'pageview', {'page': '/#how','title': 'Smart City Startups - How'});	      		
	        	window.history.pushState({},'Smart City Startups - How','#how')
	        }	 	        	        	        	           	
	      	if (target.selector.indexOf('target_top') > -1) {
	      		ga('send', 'pageview', {'page': '/','title': 'Smart City Startups'});	      		
	        	window.history.pushState({},'Smart City Startups','/')

	        	$('html,body').animate({
	        	  scrollTop: 0
	        	}, 1000);

	        	return false;
	      	}
	      	if (target.length) {
	        	$('html,body').animate({
	        	  scrollTop: target.offset().top - 110
	        	}, 1000);
	        	//window.history.pushState({},'Smart City Startups','/')
	        	return false;
	      	}

	    }
	  });
	  $("[id^='menu_']").on('click', function(){
	  		if($('#mobile_bar').is(":visible") && $('#menu_participants').is(':visible')){
	  			$('#mobile_bar').click();
	  		}

	  })
 	});
 	</script>
 
    <script type="text/javascript">
    	function moveMenu(id){
    		var curL = document.getElementById('menu_bar').getBoundingClientRect().left;
    		var targetL = document.getElementById(id).getBoundingClientRect().left + 10;
    		}
    	
    </script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-47305010-1', 'smartcitystartups.com');
	  ga('send', 'pageview');

	</script>
    <script src="assets/js/jquery.simpleWeather-2.3.min.js"></script> 
    <script type="text/javascript">
		// Docs at http://simpleweatherjs.com
		$(document).ready(function() {
		  $.simpleWeather({
		    zipcode: '',
		    woeid: '12772142',
		    location: '',
		    unit: 'f',
		    success: function(weather) {
		      html = '<h2>'+weather.temp+'&deg;'+weather.units.temp+'</h2>';
		      html += '<ul>';
		      html += '<li class="currently">'+weather.currently+' <small>and really nice!</small></li>';
		      html += '<li>'+weather.tempAlt+'&deg;C</li></ul>';
		  
		      $("#weather").html(html);
		    },
		    error: function(error) {
		      $("#weather").html('<p>'+error+'</p>');
		    }
		  });
		});

    </script> 	
	<script>
	//getUrlVars from http://papermashup.com/read-url-get-variables-withjavascript/
		function getUrlVars() {
			var vars = {};
			var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
				vars[key] = value;
			});
			return vars;
		}
		var app = angular.module( 'scs414', ['ngSanitize'] );
		app.config(['$routeProvider', '$httpProvider',
		  function($routeProvider, $httpProvider) {
		    $routeProvider.when('/sched', {
		      title: 'Schedule',
		      templateUrl: '/assets/templates/mobile_sched.tmpl.html',
		      controller: 'SchedCtrl'
		    });
		    $routeProvider.when('/map', {
		      title: 'Map',
		      templateUrl: '/assets/templates/mobile_map.tmpl.html',
		      controller: 'MapCtrl'
		    });		   
		    $routeProvider.when('/people', {
		      title: 'People',
		      templateUrl: '/assets/templates/mobile_people.tmpl.html',
		      controller: 'PeopleCtrl'
		    });		
		    $routeProvider.when('/contact', {
		      title: 'Contact',
		      templateUrl: '/assets/templates/mobile_contact.tmpl.html',
		      controller: 'ContactCtrl'
		    });			
		    $routeProvider.when('/vote', {
		      title: 'Vote',
		      templateUrl: '/assets/templates/mobile_vote.tmpl.html',
		      controller: 'VoteCtrl'
		    });		
		    $routeProvider.when('/content', {
		      title: 'Content',
		      templateUrl: '/assets/templates/mobile_content.tmpl.html',
		      controller: 'ContentCtrl'
		    });			    		    	    
		    $routeProvider.otherwise({
		      redirectTo: '/sched'
		    });

		  }
		], ['$locationProvider',
		  function($locationProvider) {
		    $locationProvider.html5Mode(true);
		  }
		]);

		app.controller( 'ContentCtrl', function( $scope ) {

		});

		app.controller( 'VoteCtrl', function( $scope ) {

		});

		app.controller( 'ContactCtrl', function( $scope ) {

		});

		app.controller( 'PeopleCtrl', function( $scope, $http, $timeout ) {
			$scope.showLegend = false;
			$scope.currLimit = 5;
			$scope.scrollVis = false;
			$scope.groups = [];
			var sheetUrl = '/assets/people.data';
			$http.get(sheetUrl, {}, {cache:false}).success(function(data){
				//console.log(data);
				$scope.people = data.Sheet1;
			});
			var checkScroll = function(){
				return document.documentElement.scrollHeight >= document.documentElement.clientHeight;
			}
			var checkLimit = function(){
				$timeout(function() {
					//console.log($scope.peopleQuery)
	            	if($('#peopleViewBottom').isOnScreen() &&  !$scope.peopleQuery && $scope.currLimit <= $scope.people.length){
	            		$scope.currLimit += 5;
	            	};
	            	if(checkScroll()){
	            		$scope.scrollVis = true;
	            	} else {
	            		$scope.scrollVis = false;
	            	}

	            	checkLimit();
	          	}, 500)
			}
			checkLimit();
			$scope.clearQ = function(){
				$scope.currLimit = 5;
				$scope.peopleQuery = "";
			}
			$scope.scrollUp = function(){
				console.log('click')
				$('html,body').animate({
	        	  scrollTop: 0
	        	}, 1000);
	        	$scope.currLimit = 5;
			}

		});


		app.controller( 'MapCtrl', function( $scope, $http, $compile ) {
			/*$('#indoorMap').panzoom({
				minScale: 10
			});*/

		});

		app.controller( 'SchedCtrl', function( $scope, $timeout ) {
			var offset = -4;
			$scope.currentTime = new Date( new Date().getTime() + offset * 3600 * 1000).toUTCString().replace( / GMT$/, "" );
			var maxTimeIndex;
			var d = new Date();
			var localTime = d.toISOString();
			$( "time" ).each( function( index, element ){
				var schedTime = $( this )[0].attributes.getNamedItem('datetime').value ;
			    if(localTime >= schedTime){
			    	console.log(index, localTime, schedTime)
			    	maxTimeIndex = index;
			    }

			});
			if(maxTimeIndex){
				var topScroll = $($( "time" )[maxTimeIndex]).offset().top
				console.log(topScroll)
				$('html,body').animate({
		        	  scrollTop: topScroll - 75
		        }, 1000);
			}

			/* CREDIT: Count down until any date script-
			By JavaScript Kit (www.javascriptkit.com)
			Over 200+ free scripts here!
			*/

			var montharray=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")

			var countdown = function(yr,m,d){
				$timeout(function() {
					theyear=yr;themonth=m;theday=d
					var today=new Date()
					var todayy=today.getYear()
					if (todayy < 1000)
						todayy+=1900
					var todaym=today.getMonth()
					var todayd=today.getDate()
					var todayh=today.getHours()
					var todaymin=today.getMinutes()
					var todaysec=today.getSeconds()
					var todaystring=montharray[todaym]+" "+todayd+", "+todayy+" "+todayh+":"+todaymin+":"+todaysec
					futurestring=montharray[m-1]+" "+d+", "+yr
					dd=Date.parse(futurestring)-Date.parse(todaystring)
					dday=Math.floor(dd/(60*60*1000*24)*1)
					dhour=Math.floor((dd%(60*60*1000*24))/(60*60*1000)*1)
					dmin=Math.floor(((dd%(60*60*1000*24))%(60*60*1000))/(60*1000)*1)
					dsec=Math.floor((((dd%(60*60*1000*24))%(60*60*1000))%(60*1000))/1000*1)
					if(dday==0&&dhour==0&&dmin==0&&dsec==1){
						$scope.timeLeft = false;
						console.log('event already starting')
						return
					} else {
						$scope.timeLeft = dday+ " days, "+dhour+" hours, "+dmin+" minutes, and "+dsec+" seconds ";
					}
					countdown(theyear,themonth,theday)
			      }, 1000);
			}
			//enter the count down date using the format year/month/day
			countdown(2014,4,24)
			/* end of modified 3rd party code*/




			var updateTime = function(){
				$timeout(function() {
			        $scope.currentTime = new Date( new Date().getTime() + offset * 3600 * 1000).toUTCString().replace( / GMT$/, "" );
			        updateTime();
			      }, 1000);
			}
			updateTime();
			

		});

	</script>
	<!-- AddThisEvent -->
	<script type="text/javascript" src="http://js.addthisevent.com/atemay.js"></script>	
  </body>
</html>
<!-- box-shadow: 0 0 0 8px #afdcf8; -->
